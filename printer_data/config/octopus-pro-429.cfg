# This file contains common pin mappings for the BigTreeTech Octopus PRO 429 variant.
# To use this config, the firmware should be compiled for
# the STM32F429 processor with a 32KiB bootloader and 8MHz clock.

# The "make flash" command does not work on the Octopus PRO. Instead, after
# running "make", copy the generated "out/klipper.bin" file to a file named
# "firmware.bin" on an SD card and then restart the Octopus PRO with that SD card.

# Serial options:
#  * PA11/PA12 for serial over USB
#  * PA9 /PA10 for serial UART
#  * PD8 /PD9  for serial UART (to ESP32 module)

# See docs/Config_Reference.md for a description of parameters.

[mcu]
##  Obtain definition by "ls -l /dev/serial/by-id/" then unplug to verify
##--------------------------------------------------------------------
serial: /dev/serial/by-id/usb-Klipper_stm32f429xx_210040001450304738313820-if00
restart_method: command
##--------------------------------------------------------------------

##  A Stepper - Left
[stepper_x]
step_pin: PE6  # DRIVER7
dir_pin: PA14
enable_pin: !PE0

[tmc5160 stepper_x]
cs_pin: PD3
spi_bus: spi1
#spi_software_sclk_pin: PA5
#spi_software_mosi_pin: PA7
#spi_software_miso_pin: PA6

##  B Stepper - Right
[stepper_y]
step_pin: PE2  # DRIVER6
dir_pin: PE3
enable_pin: !PD4
endstop_pin: PG13  # STOP5

[tmc5160 stepper_y]
cs_pin: PE1
spi_bus: spi1
#spi_software_sclk_pin: PA5
#spi_software_mosi_pin: PA7
#spi_software_miso_pin: PA6

## Z0 Stepper - Rear Center
[stepper_z]
step_pin: PC13  # DRIVER5
dir_pin: !PF0
enable_pin: !PF1
endstop_pin: ^PG14  # STOP6

[tmc2209 stepper_z]
uart_pin: PE4

## Z1 Stepper - Front Left
[stepper_z1]
step_pin: PF9  # DRIVER4
dir_pin: !PF10
enable_pin: !PG2

[tmc2209 stepper_z1]
uart_pin: PF2

## Z2 Stepper - Front Right
[stepper_z2]
step_pin: PG4  # DRIVER3
dir_pin: !PC1
enable_pin: !PA0

[tmc2209 stepper_z2]
uart_pin: PC7

[heater_bed]
heater_pin: PA3  # HE1
sensor_pin: PF3  # TB

[temperature_sensor chamber]
sensor_pin: PF4 # TCH

[temperature_fan mcu]
pin: PD12  # FAN2

[temperature_fan pi]
pin: PD13  # FAN3

[fan_generic rattrap]
pin: !PD15  # FAN5
tachometer_pin: ^PG12  # STOP4

# unused pins that are on shared SPI bus, required to be defined so that all devices on bus are addressed correctly
[static_digital_output unused_pins]
pins: PF8,PA4

#[temperature_sensor max]
#sensor_type: MAX31865
#sensor_pin: PF8
#spi_bus: spi1
